# Carregando Tabela Via Programação em SQL - Parte 1/3

SELECT COUNT(*) FROM cap10.tb_tempo;
TRUNCATE cap10.tb_tempo;

# Carregando Tabela Via Programação em SQL - Parte 2/3

## Stored Procedure
DELIMITER //
CREATE PROCEDURE cap10.carrega_tb_tempo(IN startdate DATE, IN stopdate DATE)
BEGIN
	DECLARE currentdate DATE;
    SET currentdate = startdate;
    WHILE currentdate <= stopdate DO
		INSERT INTO cap10.tb_tempo VALUE (
			YEAR(currentdate) * 10000 + MONTH(currentdate) * 100 + DAY(currentdate),
            currentdate,
            YEAR(currentdate),
            MONTH(currentdate),
            DAY(currentdate),
            QUARTER(currentdate),
            WEEKOFYEAR(currentdate),
            DATE_FORMAT(currentdate, '%W'),
            DATE_FORMAT(currentdate, '%M'),
            'f',
            CASE DAYOFYEAR(currentdate) WHEN 1 THEN 't' WHEN 7 THEN 't' ELSE 'f' END);
		SET currentdate = ADDDATE(currentdate, INTERVAL 1 DAY);
	END WHILE;
END
//

# Carregando Tabela Via Programação em SQL - Parte 3/3

CALL cap10.carrega_tb_tempo('2010-01-01', '2030-12-31');

SELECT * FROM cap10.tb_tempo ORDER BY data DESC;

## Carga de Dados

## Limpa a tabela
TRUNCATE cap10.TB_VENDA;

## Carrega os dados
INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (1, 3, 7, 20120918, 400, 3);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (4, 10, 1, 20120918, 645.30, 2);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (2, 6, 8, 20120919, 178.15, 8);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (1, 9, 2, 20120920, 329.01, 1);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (5, 10, 2, 20120920, 540.90, 6);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (9, 1, 6, 20120920, 280.23, 5);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (8, 2, 7, 20120922, 445.91, 2);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (9, 6, 1, 20120922, 391.10, 4);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (1, 4, 5, 20120922, 550.43, 7);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (4, 10, 5, 20120923, 230.98, 2);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (5, 5, 7, 20120924, 500, 3);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (4, 1, 4, 20120924, 745.30, 2);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (3, 6, 8, 20120925, 478.15, 8);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (10, 9, 2, 20120925, 629.01, 1);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (10, 10, 2, 20120925, 140.90, 6);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (6, 1, 6, 20120925, 680.23, 5);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (6, 2, 7, 20120926, 945.91, 2);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (7, 6, 1, 20120926, 891.10, 4);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (8, 4, 5, 20120926, 850.43, 7);

INSERT INTO cap10.TB_VENDA (SK_CLIENTE, SK_PRODUTO, SK_LOCALIDADE, SK_DATA, VALOR_VENDA, QUANTIDADE_VENDA) 
VALUES (9, 10, 5, 20120926, 130.98, 2);

SELECT * FROM cap10.tb_venda;